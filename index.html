<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>VRRefiner Maintenance</title>
  <style>
    body {
      font-family: "Times New Roman", serif;
      font-size: 12px;
      background-color: #f4f6f9;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #2e3c50;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background-color: white;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
      vertical-align: top;
    }

    th {
      background-color: #d9e6f2;
    }

    select, textarea, input[type="file"] {
      width: 100%;
      font-family: "Times New Roman", serif;
      font-size: 12px;
    }

    .status-green { color: green; }
    .status-red { color: red; }
    .status-yellow { color: goldenrod; }
    .status-purple { color: purple; }
    .status-white { color: gray; }

    #saveBtn {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 12px;
      font-family: "Times New Roman", serif;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>VRRefiner Maintenance</h1>

  <button id="saveBtn" onclick="exportToExcel()">Save to Excel</button>

  <table id="maintenanceTable">
    <thead>
      <tr>
        <th>Site Name</th>
        <th>Inspection Date</th>
        <th>Device Status</th>
        <th>Issue Picture</th>
        <th>Issues Notes</th>
        <th>Work Plan</th>
        <th>Responsible Person</th>
        <th>Needed HSE Documents</th>
      </tr>
    </thead>
    <tbody>
      <!-- Template row, repeated 25 times with different site names -->
      <script>
        const sites = [
          "RUSAYL OMAN OIL 7307", "SQU", "MAABILLAH MEGA", "SEH AHMAR", "HALBAN EXPRESSWAY",
          "AL ANSAB EXPRESSWAY", "BURJ AL SAHWA", "HAY ALTADHAMUN", "SUWAIQ", "BURAIMI HW",
          "FALAJ ALQABAIL", "GHALA EXPRESSWAY", "QURUM SS", "MAWALEH CITY CENTRE SS", "ALKHUWAIR",
          "MANAL SS", "AL BURAIK", "SARFEET", "AL FATEH", "AL SAAD NEW",
          "MULADAH SS", "MIRBAT", "SHINAS FILLING STATION", "AL WADI SS", "SUSTAINABLE OASIS FS"
        ];
        const today = new Date().toLocaleDateString('en-GB');
        const tbody = document.currentScript.parentElement;
        sites.forEach(site => {
          const row = `
            <tr>
              <td>${site}</td>
              <td style="direction: ltr;">${today}</td>
              <td>
                <select>
                  <option class="status-green">VRR Working well</option>
                  <option class="status-red">VRR not working-Needs team check & care</option>
                  <option class="status-red">VRR show low recovery-Needs team check & care</option>
                  <option class="status-yellow">VRR Under observation</option>
                  <option class="status-purple">Oman Oil Responsibility</option>
                  <option class="status-red">Need Cleaning - See the graph</option>
                  <option class="status-white">VRR Under Maintenance</option>
                </select>
              </td>
              <td><input type="file" accept="image/*"></td>
              <td><textarea rows="2"></textarea></td>
              <td><textarea rows="2"></textarea></td>
              <td>
                <select>
                  <option>Non</option>
                  <option>Arjun Chakramanath</option>
                  <option>Ahmed Saif Ahmed Al Hadhrami</option>
                  <option>Said Ali Salim Bait Said</option>
                  <option>Sultan Al-Ruzaiqi</option>
                  <option>Unni - Compressor Team</option>
                </select>
              </td>
              <td><textarea rows="2"></textarea></td>
            </tr>
          `;
          tbody.insertAdjacentHTML('beforeend', row);
        });
      </script>
    </tbody>
  </table>

  <!-- SheetJS Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    function exportToExcel() {
      var table = document.getElementById("maintenanceTable");
      var wb = XLSX.utils.table_to_book(table, { sheet: "Maintenance" });
      XLSX.writeFile(wb, "VRRefiner_Maintenance.xlsx");
    }
  </script>
</body>
</html>

